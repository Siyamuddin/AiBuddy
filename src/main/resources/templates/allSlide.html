
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slides Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-top: 20px;
            font-size: 2.5rem;
            color: #4CAF50;
        }

        #slides-container {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 1200px;
        }

        .slide-card {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 15px 0;
            width: 100%;
            max-width: 500px;
            transition: transform 0.2s;
        }

        .slide-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

        .card-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #343a40;
            margin-bottom: 15px;
        }

        .section {
            margin-bottom: 15px;
        }

        .section h4 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: #495057;
        }

        .section p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: #6c757d;
        }

        .read-more {
            font-size: 0.9rem;
            color: #4CAF50;
            cursor: pointer;
            text-decoration: underline;
        }

        button {
            background-color: #4CAF50;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #4CAF50;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .slide-card {
                max-width: 90%;
                padding: 15px;
            }

            button {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
        }
        /* CSS */
        .generating-button {
            /* Base styles */
            /* ... */

            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
            100% {
                opacity: 1;
            }
        }
        #totalSlide {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        #totalSlide span {
            color: #4CAF50; /* Red color for the slide count */
        }
    </style>
</head>
<body>
<h1>Slide Dashboard</h1>
<div id="totalSlide">
<h3>Total Slide :<span th:text="${size}"></span></h3>
</div>
<div id="slides-container"></div>
<input type="hidden" id="userId" th:value="${user.getId()}">

<script>
    // Function to fetch and display slides for a specific user
    async function fetchAndRenderSlides() {
        const userId = document.getElementById("userId").value; // Get user ID
        const response = await fetch(`http://localhost:8080/api/v1/slide/get/all/user/${userId}`); // Fetch slides from API
        const data = await response.json(); // Parse response as JSON

        const slidesContainer = document.getElementById('slides-container');
        slidesContainer.innerHTML = ''; // Clear any existing content in the container

        // Iterate through each slide and create a card for it
        data.forEach(slide => {
            const card = document.createElement('div'); // Create a card element
            card.classList.add('slide-card');

            // Add slide title
            const title = document.createElement('h3');
            title.classList.add('card-title');
            title.textContent = slide.slideTitle; // Set slide title
            card.appendChild(title);

            // Add "Generate Questions" section
            card.appendChild(createGenerateSection('Questions', slide.generatedQuestions, () => generateShortQuestions(slide.id)));

            // Add "Generate MCQs" section
            card.appendChild(createGenerateSection('MCQs', slide.generatedMCQ, () => generateMCQs(slide.id)));

            // Add "Generate Summary" section
            card.appendChild(createGenerateSectionSummary('Summary', slide.slideSummary, () => generateSummary(slide.id)));

            // Add "Slide Content" section
            card.appendChild(createReadMoreSection('Slide Content', slide.slideContent));

            slidesContainer.appendChild(card); // Append the card to the container
        });
    }

    // Function to create a reusable "Generate Content" section
    function createGenerateSection(label, content, generateFunc) {
        const section = document.createElement('div');
        section.classList.add('section');

        // Add content preview
        const contentContainer = createReadMoreSection(label, content);
        section.appendChild(contentContainer);

        // Add "Generate" button
        const generateButton = document.createElement('button');
        generateButton.textContent = `Generate ${label}`;
        generateButton.onclick = async () => {
            // Change button state while generating
            generateButton.textContent = 'Generating...';
            const number = prompt(`Enter number of ${label.toLowerCase()} to generate:`); // Prompt user for number of items
            if (number) await generateFunc(number); // Call the provided generation function
            await fetchAndRenderSlides(); // Refresh slides after generation
        };
        section.appendChild(generateButton);

        return section; // Return the complete section
    }

    // Similar to createGenerateSection but for summary
    function createGenerateSectionSummary(label, content, generateFunc) {
        const section = document.createElement('div');
        section.classList.add('section');

        // Add content preview
        const contentContainer = createReadMoreSection(label, content);
        section.appendChild(contentContainer);

        // Add "Generate Summary" button
        const generateButton = document.createElement('button');
        generateButton.textContent = `Generate ${label}`;
        generateButton.onclick = async () => {
            generateButton.textContent = 'Generating...';
            await generateFunc(); // Generate summary (no additional input required)
            await fetchAndRenderSlides(); // Refresh slides after generation
        };
        section.appendChild(generateButton);

        return section;
    }

    // API call to generate short questions for a slide
    async function generateShortQuestions(slideID, numQuestions) {
        await fetch(`http://localhost:8080/api/v1/slide/generate/sq/${slideID}/${numQuestions}`);
    }

    // API call to generate MCQs for a slide
    async function generateMCQs(slideID, numMCQs) {
        await fetch(`http://localhost:8080/api/v1/slide/generate/mcq/${slideID}/${numMCQs}`);
    }

    // API call to generate summary for a slide
    async function generateSummary(slideID) {
        await fetch(`http://localhost:8080/api/v1/slide/generate/summary/${slideID}`);
    }

    // Function to create a "Read More" section for displaying content
    function createReadMoreSection(label, content) {
        const section = document.createElement('div');
        section.classList.add('section');

        // Add label/title for the content
        const labelElem = document.createElement('h4');
        labelElem.textContent = label;
        section.appendChild(labelElem);

        // Add content preview (truncated if too long)
        const contentElem = document.createElement('p');
        contentElem.textContent = content ? content.slice(0, 100) : 'Click generate to generate the content';
        section.appendChild(contentElem);

        // Add "Read More" toggle for long content
        if (content && content.length > 100) {
            const toggleLink = document.createElement('span');
            toggleLink.textContent = ' Read More';
            toggleLink.classList.add('read-more');

            toggleLink.onclick = () => {
                // Toggle between full content and preview
                if (toggleLink.textContent === ' Read More') {
                    contentElem.textContent = content;
                    toggleLink.textContent = ' Read Less';
                } else {
                    contentElem.textContent = content.slice(0, 100);
                    toggleLink.textContent = ' Read More';
                }
            };

            section.appendChild(toggleLink);
        }

        return section; // Return the complete section
    }

    // Fetch and render slides when the page loads
    fetchAndRenderSlides();
</script>


<!--<script>-->
<!--    // (JavaScript code remains the same as in your original code)-->
<!--    async function fetchAndRenderSlides() {-->
<!--        const userId = document.getElementById("userId").value;-->
<!--        const response = await fetch(`http://localhost:8080/api/v1/slide/get/all/user/${userId}`);-->
<!--        const data = await response.json();-->

<!--        const slidesContainer = document.getElementById('slides-container');-->
<!--        slidesContainer.innerHTML = ''; // Clear existing content-->

<!--        data.forEach(slide => {-->
<!--            // Create slide card-->
<!--            const card = document.createElement('div');-->
<!--            card.classList.add('slide-card');-->

<!--            // Title-->
<!--            const title = document.createElement('h3');-->
<!--            title.classList.add('card-title');-->

<!--            title.textContent = slide.slideTitle;-->
<!--            card.appendChild(title);-->

<!--            // Generate Short Questions Section-->
<!--            card.appendChild(createGenerateSection('Questions', slide.generatedQuestions, () => generateShortQuestions(slide.id)));-->

<!--            // Generate MCQs Section-->
<!--            card.appendChild(createGenerateSection('MCQs', slide.generatedMCQ, () => generateMCQs(slide.id)));-->

<!--            // Generate Summary Section-->
<!--            card.appendChild(createGenerateSectionSummary('Summary', slide.slideSummary, () => generateSummary(slide.id)));-->

<!--            // Slide Content Section-->
<!--            card.appendChild(createReadMoreSection('Slide Content',slide.slideContent));-->
<!--            slidesContainer.appendChild(card);-->
<!--        });-->
<!--    }-->

<!--    function createGenerateSection(label, content, generateFunc) {-->
<!--        const section = document.createElement('div');-->
<!--        section.classList.add('section');-->

<!--        const contentContainer = createReadMoreSection(label, content);-->
<!--        section.appendChild(contentContainer);-->

<!--        const generateButton = document.createElement('button');-->
<!--        generateButton.textContent = `Generated ${label} `;-->
<!--        generateButton.onclick = async () => {-->
<!--            // JavaScript-->
<!--            generateButton.classList.add('generating-button');-->
<!--            generateButton.textContent = 'Generating...';-->
<!--            const number = prompt(`Enter number of ${label.toLowerCase()} to generate:`);-->
<!--            if (number) await generateFunc(number);-->
<!--            await fetchAndRenderSlides(); // Refresh slides after generation-->
<!--        };-->
<!--        section.appendChild(generateButton);-->

<!--        return section;-->
<!--    }-->

<!--    function createGenerateSectionSummary(label, content, generateFunc) {-->
<!--        const section = document.createElement('div');-->
<!--        section.classList.add('section');-->

<!--        const contentContainer = createReadMoreSection(label, content);-->
<!--        section.appendChild(contentContainer);-->

<!--        const generateButton = document.createElement('button');-->
<!--        generateButton.textContent = `Generate ${label}`;-->
<!--        generateButton.onclick = async () => {-->
<!--            // JavaScript-->
<!--            generateButton.classList.add('generating-button');-->
<!--            generateButton.textContent = 'Generating...';-->
<!--            const number = 1;-->
<!--            if (number) await generateFunc(number);-->
<!--            await fetchAndRenderSlides(); // Refresh slides after generation-->
<!--        };-->
<!--        section.appendChild(generateButton);-->

<!--        return section;-->
<!--    }-->

<!--    async function generateShortQuestions(slideID, numQuestions) {-->
<!--        await fetch(`http://localhost:8080/api/v1/slide/generate/sq/${slideID}/${numQuestions}`);-->
<!--    }-->

<!--    async function generateMCQs(slideID, numMCQs) {-->
<!--        await fetch(`http://localhost:8080/api/v1/slide/generate/mcq/${slideID}/${numMCQs}`);-->
<!--    }-->

<!--    async function generateSummary(slideID) {-->
<!--        await fetch(`http://localhost:8080/api/v1/slide/generate/summary/${slideID}`);-->
<!--    }-->

<!--    function createReadMoreSection(label, content) {-->
<!--        const section = document.createElement('div');-->
<!--        section.classList.add('section');-->

<!--        const labelElem = document.createElement('h4');-->
<!--        labelElem.textContent = label;-->
<!--        section.appendChild(labelElem);-->

<!--        const contentElem = document.createElement('p');-->
<!--        contentElem.textContent = content ? content.slice(0, 100) : 'Click generate to generate the content';-->
<!--        section.appendChild(contentElem);-->

<!--        if (content && content.length > 100) {-->
<!--            const toggleLink = document.createElement('span');-->
<!--            toggleLink.textContent = ' Read More';-->
<!--            toggleLink.classList.add('read-more');-->

<!--            toggleLink.onclick = () => {-->
<!--                if (toggleLink.textContent === ' Read More') {-->
<!--                    contentElem.textContent = content;-->
<!--                    toggleLink.textContent = ' Read Less';-->
<!--                } else {-->
<!--                    contentElem.textContent = content.slice(0, 100);-->
<!--                    toggleLink.textContent = ' Read More';-->
<!--                }-->
<!--            };-->

<!--            section.appendChild(toggleLink);-->
<!--        }-->

<!--        return section;-->
<!--    }-->

<!--fetchAndRenderSlides();-->
<!--</script>-->
</body>
</html>
